<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>main API documentation</title>
<meta name="description" content="Main file of the application …" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>main</code></h1>
</header>
<section id="section-intro">
<p>Main file of the application</p>
<p>Author: Alejandro Sanchez Rodriguez
Date: 2023-06-22</p>
<p>This file contains the main code of the application. It creates the GUI and defines the functions that
are executed when the user interacts with the widgets.
It also works with the SQLite database and the Excel modules.
It's a general purpose form to structure and cleanly define data models. It can be repurposed for
any project that has a well-defined data structure.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#39;&#39;&#39;Main file of the application

Author: Alejandro Sanchez Rodriguez
Date: 2023-06-22

This file contains the main code of the application. It creates the GUI and defines the functions that
are executed when the user interacts with the widgets.
It also works with the SQLite database and the Excel modules.
It&#39;s a general purpose form to structure and cleanly define data models. It can be repurposed for
any project that has a well-defined data structure.
&#39;&#39;&#39;


# Import libraries
import tkinter as tk
from tkinter import PhotoImage, ttk, messagebox
from PIL import Image, ImageTk
from tkcalendar import DateEntry
import db
from excel import Excel
import tk_utils
import configparser
import os
import re


################################################################################
def buscar_id():
    &#39;&#39;&#39;Create a function that searches for a record in the database from a given ID&#39;&#39;&#39;
    # If the entry field is empty, show an error message
    if not identificador.get():
        messagebox.showerror(&#34;Error&#34;, &#34;El campo ID es obligatorio&#34;)
    else:
        # Clear the entry fields and comboboxes
        clear()
        # Search for the record in the database
        record = database.get_registro(identificador.get())
        # If the record exists, fill the entry fields and comboboxes with its values
        if record:
            print(record)
        # If the record doesn&#39;t exist, show an error message
        else:
            messagebox.showerror(&#34;Error&#34;, &#34;No existe ningún registro con ese ID&#34;)

def submit():
    &#39;&#39;&#39;Create a function that submits the form&#39;&#39;&#39;
    # If operador is not selected, show an error message
    if not operador.get():
        messagebox.showerror(&#34;Error&#34;, &#34;El campo operador es obligatorio&#34;)
        return

    # If any of the entry fields or comboboxes are empty, show an error message
    if not fecha_entrada.get() or not observaciones.get(&#39;1.0&#39;, &#34;end-1c&#34;) or \
            not identificador.get() or not importe.get() or estados_cb.get() == &#34;--&#34; or \
            (estados_cb.get() == &#34;INCIDENCIA&#34; and \
                (not fecha_resolucion.get() or not operador_resolucion.get() \
                or not num_llamadas.get() or not campo.get())):
        messagebox.showerror(&#34;Error&#34;, &#34;Todos los campos son obligatorios&#34;)
        return
    
    # If the record already exists, ask for confirmation to overwrite it
    if database.get_registro_by(&#34;identificador&#34;, identificador.get()):
        if not messagebox.askyesno(&#34;Confirmar&#34;, &#34;Ya existe un registro con ese ID. ¿Desea sobreescribirlo?&#34;):
            return
        
    # If the record doesn&#39;t exist, ask for confirmation to create it
    elif not messagebox.askyesno(&#34;Confirmar&#34;, &#34;¿Desea crear un nuevo registro?&#34;):
        return

    # Create a list with the values of the entry fields and comboboxes
    values = [
        fecha_entrada.get(),
        operador.get(),
        identificador.get(),
        importe.get(),
        estados_cb.get(),
        campo.get(),
        int(num_llamadas.get()) if num_llamadas.get() else 0,
        fecha_resolucion.get(),
        operador_resolucion.get(),
        observaciones.get(&#39;1.0&#39;, &#34;end-1c&#34;),
    ]

    # Insert the record in the database
    database.insert_registro(values)

    # Clear the entry fields and comboboxes
    clear()

def clear():
    &#39;&#39;&#39;Create a function that clears the form&#39;&#39;&#39;
    # Clear the entry fields and comboboxes
    fecha_entrada.set(&#34;&#34;)
    identificador.set(&#34;&#34;)
    importe.set(&#34;&#34;)
    operador.set(&#34;&#34;)
    estados_cb.current(0)
    campo.set(&#34;&#34;)
    fecha_resolucion.set(&#34;&#34;)
    operador_resolucion.set(&#34;&#34;)
    observaciones.delete(&#39;1.0&#39;, &#34;end-1c&#34;)
    num_llamadas.set(&#34;&#34;)

def toggle_use_incidencias(new_state):
    &#39;&#39;&#39;Create a function that disables or enables every field in the incidencias category&#39;&#39;&#39;
    # Disable or enable every field in the incidencias category
    campo_label.configure(state=new_state)
    campo_entry.configure(state=new_state)
    fres_label.configure(state=new_state)
    cal_resolucion.configure(state=new_state)
    opres_label.configure(state=new_state)
    oper_res_cb.configure(state=new_state)
    num_label.configure(state=new_state)
    num_entry.configure(state=new_state)

def estado_seleccionado(event):
    &#39;&#39;&#39;Create a Listener for the estado combobox&#39;&#39;&#39;
    if estados_cb.get() == &#34;INCIDENCIA&#34;:
        toggle_use_incidencias(&#34;enabled&#34;)
    else:
        toggle_use_incidencias(&#34;disabled&#34;)

def verificar_numerico(char):
    &#39;&#39;&#39;Create a function that validates an entry field and accepts only numbers and dots&#39;&#39;&#39;
    return char.isdigit() or char == &#34;&#34; or char == &#34;.&#34;

def exportar_aux():
    &#39;&#39;&#39;
        Create a function that shows an auxiliary window to choose whether to 
        extract all the registers or only ones within a certain date range
    &#39;&#39;&#39;
    # Create a new window
    export_window = tk.Toplevel()
    export_window.title(&#34;Exportar&#34;)
    export_window.resizable(False, False)
    export_window.iconbitmap(&#34;imgs/favicon.ico&#34;)

    # Create a label to show a message to the user
    label = tk.Label(export_window, text=&#34;¿Qué registros desea exportar?&#34;, font=(&#34;Gotham Bold&#34;, 14))
    label.grid(row=0, column=0, columnspan=3, pady=10)

    # Create a button to export all the registers
    button_all = tk.Button(export_window, text=&#34;Todos&#34;, 
            command= lambda: [exportar(0, None), export_window.destroy()])
    button_all.grid(row=1, column=0, pady=3)

    # Create a frame to group the date selectors
    frame = tk.Frame(export_window)
    frame.grid(row=1, column=1, pady=3)

    # Create two date selectors to choose the date range
    date_from = DateEntry(frame, width=12, background=&#39;darkblue&#39;, foreground=&#39;white&#39;, 
                        borderwidth=2, locale=&#34;es_ES&#34;, date_pattern=&#34;dd-MM-yyyy&#34;)
    date_from.pack(pady=3)
    date_to = DateEntry(frame, width=12, background=&#39;darkblue&#39;, foreground=&#39;white&#39;, 
                        borderwidth=2, locale=&#34;es_ES&#34;, date_pattern=&#34;dd-MM-yyyy&#34;)
    date_to.pack(pady=3)

    # Create a button to export only the registers within a certain date range
    button_range = tk.Button(frame, text=&#34;Rango de fechas&#34;, 
            command= lambda: [exportar(1, f&#34;{date_from.get()} - {date_to.get()}&#34;), export_window.destroy()])
    button_range.pack(pady=3)

    # Create a frame to group the date selector and button
    frame2 = tk.Frame(export_window)
    frame2.grid(row=1, column=2, pady=3)

    # Create a date selector and button to export only the registers from a certain date
    date = DateEntry(frame2, width=12, background=&#39;darkblue&#39;, foreground=&#39;white&#39;, 
                        borderwidth=2, locale=&#34;es_ES&#34;, date_pattern=&#34;dd-MM-yyyy&#34;)
    date.pack(pady=3)
    button_date = tk.Button(frame2, text=&#34;A partir de una fecha&#34;,
            command= lambda: [exportar(2, f&#34;{date.get()}&#34;), export_window.destroy()])
    button_date.pack(pady=3)

    # Create a button to close the window
    button_close = tk.Button(export_window, text=&#34;Cerrar&#34;, command=export_window.destroy)
    button_close.grid(row=2, column=0, columnspan=3, pady=3)

    tk_utils.centrar_ventana(export_window)

def exportar(selector, fechas=&#34;&#34;, window=None):
    &#39;&#39;&#39;Create a function that extracts the data from the database and creates an Excel file&#39;&#39;&#39;
    # Get the data from the database
    data = None
    nombre = None
    if selector == 1:
        aux = fechas.split(&#34; - &#34;)
        fechas = (aux[0], aux[1])
        data = database.get_all_registros_fecha_entrada(fechas)
        nombre = f&#34;Extracción {aux[0]} - {aux[1]}.xlsx&#34;
    elif selector == 2:
        data = database.get_all_registros_fecha_entrada(fechas)
        nombre = f&#34;Extracción {fechas}.xlsx&#34;
    else:
        data = database.get_all_registros()
        nombre = &#34;Extracción global.xlsx&#34;

    # Create a new Excel file
    excel = Excel()
    excel.crear_archivo(nombre)

    # Add headers to the Excel file
    excel.rellenar_cabeceras(cabeceras)

    # Add the data to the Excel file
    excel.rellenar_hoja(data)

    # Format the Excel file
    excel.formato_hoja()
    excel.formato_cabecera()

    # Save the Excel file
    excel.guardar_archivo_como()

    # Close the Excel file
    excel.cerrar_archivo()

    # Show a message to the user
    messagebox.showinfo(&#34;Información&#34;, &#34;El archivo se ha exportado correctamente&#34;)

def verificar_cabeceras(headers):
    &#39;&#39;&#39;Create a function that verifies the Excel file headers&#39;&#39;&#39;
    # Check if the headers are correct
    if headers != cabeceras[1:]:
        # Show a message to the user
        messagebox.showerror(&#34;Error&#34;, &#34;El archivo no tiene los campos correctos&#34;)
        return False
    return True

def verificar_datos(datos):
    &#39;&#39;&#39;Create a function that verifies the integrity of the data&#39;&#39;&#39;
    date_regex = r&#34;^\d{2}-\d{2}-\d{4}$&#34;
    for registro in datos:
        # Check if fecha entrada has a valid date format
        if not re.match(date_regex, registro[0]):
            messagebox.showerror(&#34;Error&#34;, &#34;Fecha de entrada incorrecta&#34;)
            return False
        # Check if the next 2 fields are empty
        if registro[1] != &#34;&#34; or registro[2] != &#34;&#34;:
            messagebox.showerror(&#34;Error&#34;, &#34;El registro tiene campos vacíos&#34;)
            return False
        # Check if importe is a valid number
        try:
            float(registro[3])
        except ValueError:
            messagebox.showerror(&#34;Error&#34;, &#34;Importe incorrecto&#34;)
            return False
        # If estado is INCIDENCIA, check whether the next fields are valid
        if registro[4] == &#34;INCIDENCIA&#34;:
            # Check if registro[5][8][9] are empty
            if registro[5] != &#34;&#34; or registro[8] != &#34;&#34; or registro[9] != &#34;&#34;:
                messagebox.showerror(&#34;Error&#34;, &#34;El registro tiene campos vacíos&#34;)
                return False
            # Check if registro[6] is a valid integer
            try:
                int(registro[6])
            except ValueError:
                messagebox.showerror(&#34;Error&#34;, &#34;Número de llamadas incorrecto&#34;)
                return False
            # Check if registro[7] is a valid date
            if not re.match(date_regex, registro[7]):
                messagebox.showerror(&#34;Error&#34;, &#34;Fecha de resolución incorrecta&#34;)
                return False
    return True

def importar():
    &#39;&#39;&#39;Create a function that imports data from an Excel file to the database&#39;&#39;&#39;
    # Create a new Excel file
    excel = Excel()
    excel.cargar_archivo()

    # Check format integrity and insert the data in the database
    if not verificar_cabeceras(excel.datos[0]):
        messagebox.showerror(&#34;Error&#34;, &#34;El archivo no tiene el formato correcto&#34;)
        return
    elif not verificar_datos(excel.datos[1:]):
        return
    else:
        # Delete the headers from the data
        del excel.datos[0]

        # Insert the data in the database
        database.insert_multiples_registros(excel.datos)

    # Show a message to the user
    messagebox.showinfo(&#34;Información&#34;, &#34;El archivo se ha importado correctamente&#34;)

def help():
    &#39;&#39;&#39;Create a function that displays an overlay with help for the user&#39;&#39;&#39;
    # Create a new window
    ventana_ayuda = tk.Toplevel(ventana_principal)
    ventana_ayuda.title(&#34;Ayuda&#34;)
    ventana_ayuda.resizable(False, False)
    ventana_ayuda.iconbitmap(&#34;imgs/favicon.ico&#34;)
    ventana_ayuda.configure(background=&#34;#FFFFFF&#34;)

    # Create a frame for the content
    frame = ttk.Frame(ventana_ayuda)
    frame.pack(padx=10, pady=10)

    # Create a label with the help text
    help_text = &#34;&#34;&#34;
        Este programa permite registrar, buscar, modificar y eliminar registros de 
        **NOMBRE DEL SERVICIO**.\n
        - Para registrar un nuevo registro, rellene todos los campos del formulario y
        pulse el botón &#34;Confirmar. Todos los campos del cuerpo principal son
        obligatorios.\n
        - Para vaciar el formulario, pulse el botón &#34;Limpiar&#34;.\n
        - Si el estado del registro es &#34;INCIDENCIA&#34;, se habilitarán los campos
        &#34;Campo&#34;, &#34;Fecha de resolución&#34;, &#34;Operador de resolución&#34; y &#34;Número de
        llamadas&#34;, que pasarán a ser obligatorios.\n
        - Para buscar un registro, introduzca su ID en el campo correspondiente y
        pulse el botón &#34;Buscar&#34; (icono de lupa).\n
        - Para modificar un registro, busque el registro y modifique los campos que
        desee. Pulse el botón &#34;Confirmar&#34; para guardar los cambios.\n
        - Para eliminar un registro, busque el registro y pulse el botón &#34;Eliminar&#34;.
        Se mostrará una ventana de confirmación.\n\n
        - Para exportar los registros a Excel o cargar un fichero de datos, pulse 
        los botones &#34;Exportar&#34; e &#34;Importar&#34; del menú &#34;Archivo&#34;, respectivamente.\n\n
    &#34;&#34;&#34;

    title_label = ttk.Label(frame, text=&#34;Ayuda&#34;, font=(&#34;Gotham&#34;, 18, &#34;bold&#34;))
    title_label.grid(row=0, column=0, padx=10, pady=10, sticky=&#34;NSEW&#34;)

    help_label = ttk.Label(frame, text=help_text)
    help_label.grid(row=1, column=0, padx=10, pady=10, sticky=&#34;NSEW&#34;)

    # Create a button to close the window
    close_button = ttk.Button(frame, text=&#34;Cerrar&#34;, command=ventana_ayuda.destroy)
    close_button.grid(row=2, column=0, padx=10, pady=10, sticky=&#34;NSEW&#34;)

    # Center the window
    tk_utils.centrar_ventana(ventana_ayuda)

    # Show the window
    ventana_ayuda.mainloop()

def about():
    &#39;&#39;&#39;Mensaje de información&#39;&#39;&#39;
    messagebox.showinfo(&#34;Información&#34;, &#34;Aplicación creada por Alejandro Sánchez Rodríguez&#34;)


################################################################################
config = configparser.ConfigParser()
config.read(&#39;config.ini&#39;)

# Create a database instance
DB_FILE = config[&#34;DB&#34;][&#34;DB_FILENAME&#34;]
DB_FILE = os.path.join(os.path.dirname(__file__), DB_FILE)
database = db.Database(DB_FILE)

# All needed collections are defined here
usuarios = database.get_all_usuarios()
cabeceras = [&#34;ID&#34;, &#34;Fecha entrada&#34;, &#34;Operador&#34;, &#34;Identificador&#34;, 
            &#34;Importe&#34;, &#34;Estado&#34;, &#34;Campo&#34;, &#34;Nº llamadas&#34;, &#34;Fecha resolución&#34;, 
            &#34;Operador resolución&#34;, &#34;Observaciones&#34;]


################################################################################
# Create GUI window
ventana_principal = tk.Tk()
ventana_principal.title(&#34;Nombre del servicio&#34;)
ventana_principal.resizable(False, False)
ventana_principal.iconbitmap(&#34;imgs/favicon.ico&#34;)
ventana_principal.configure(background=&#34;#FFFFFF&#34;)

# Add a style
STYLE_THEME = config[&#34;STYLES&#34;][&#34;THEME&#34;]
style = ttk.Style(ventana_principal)
style.configure(&#34;TFrame&#34;, background=&#34;#FFFFFF&#34;)
style.configure(&#34;TLabel&#34;, font=(&#34;Gotham&#34;, 12), padding=(15, 5, 5, 5), 
    foreground=&#34;#00558C&#34;, background=&#34;#FFFFFF&#34;)
style.configure(&#34;TButton&#34;, font=(&#34;Gotham&#34;, 12), padding=(5, 5, 5, 5),
    width=16, cursor=&#34;hand2&#34;, justify=tk.CENTER, background=&#34;#FFFFFF&#34;)
style.configure(&#34;TEntry&#34;, font=(&#34;Gotham Light&#34;, 12), width=22)
# SVF Colour #00558C
# SVF Colour lighter #376887

################################################################################
# Add a menu
menu = tk.Menu(ventana_principal)
ventana_principal.config(menu=menu)
# Add a file menu with commands to load and extract excel files
file_menu = tk.Menu(menu, tearoff=False)
menu.add_cascade(label=&#34;Archivo&#34;, menu=file_menu)
file_menu.add_command(label=&#34;Exportar informe&#34;, command=exportar_aux)
file_menu.add_command(label=&#34;Importar datos&#34;, command=importar)
file_menu.add_command(label=&#34;Salir&#34;, command=ventana_principal.quit)
# Add a help menu
help_menu = tk.Menu(menu, tearoff=False)
menu.add_cascade(label=&#34;Ayuda&#34;, menu=help_menu)
help_menu.add_command(label=&#34;Ayuda&#34;, command=help)
help_menu.add_command(label=&#34;Acerca de...&#34;, command=about)


################################################################################
# Add a label
marco_titulo = ttk.Frame(ventana_principal, style=&#34;TFrame&#34;)
logo_img = ImageTk.PhotoImage(Image.open(&#34;./imgs/logo.JPG&#34;).resize((80, 100)))
logo_label = ttk.Label(
    marco_titulo,
    image=logo_img,
    background=&#34;#FFFFFF&#34;,
)
logo_label.grid(column=0, row=0, sticky=tk.E)
titulo = ttk.Label(
    marco_titulo, 
    text=&#34;Nombre del servicio&#34;,
    font=(&#34;Gotham&#34;, 30),
    padding=(20, 20),
    justify=tk.CENTER,
    anchor=tk.CENTER,
    width=20
)
titulo.grid(column=1, row=0, columnspan=4, sticky=tk.W)
marco_titulo.grid(column=0, row=0, columnspan=4)


################################################################################
# Create a frame for the comboboxes
factores_principales = ttk.Frame(ventana_principal, style=&#34;TFrame&#34;, relief=tk.RAISED, borderwidth=2)
factores_principales.grid(column=0, row=1, columnspan=4, pady=(10, 10), padx=(10, 10))

# Add a combobox from which to select the user
ttk.Label(factores_principales, text=&#34;Operador:&#34;, font=(&#34;Gotham&#34;, 14))\
    .grid(column=0, row=0, sticky=tk.E, pady=(5, 15), padx=(15, 0))
operador = tk.StringVar()
operador_cb = ttk.Combobox(factores_principales, textvariable=operador, state=&#34;readonly&#34;,\
                            font=(&#34;Gotham&#34;, 12), width=25, justify=tk.CENTER)
operador_cb[&#34;values&#34;] = [(f&#34;{u[1]} - {u[2]}&#34;) for u in usuarios]
operador_cb.grid(column=1, row=0, columnspan=2, pady=(5, 15), padx=(15, 15))


################################################################################
# Add a frame for the entry fields
marco_formulario = ttk.Frame(ventana_principal, style=&#34;TFrame&#34;)
marco_formulario.grid(column=0, row=2, columnspan=4, pady=(10, 10), padx=(20))

# Add entry fields
fecha_entrada = tk.StringVar()
identificador = tk.StringVar()
importe = tk.DoubleVar()
campo = tk.StringVar()
num_llamadas = tk.StringVar()
fecha_resolucion = tk.StringVar()
operador_resolucion = tk.StringVar()
observaciones = tk.StringVar()

# Dynamically advance the row counter to structure the form
row_form = 0

################################################################################
# Add a separator to define a section
ttk.Separator(marco_formulario,orient=&#39;horizontal&#39;)\
    .grid(column=0, row=row_form, columnspan=8, sticky=&#39;ew&#39;, pady=5)
row_form += 1

# Add a date entry field
ttk.Label(marco_formulario, text=&#34;Fecha de\nentrada:&#34;)\
    .grid(column=0, row=row_form, sticky=tk.E)
cal_entrada = DateEntry(marco_formulario, textvariable=fecha_entrada, font=(&#34;Gotham Light&#34;, 10),
    justify=tk.CENTER, width=20, locale=&#34;es_ES&#34;, date_pattern=&#34;dd-MM-yyyy&#34;)
cal_entrada.grid(column=1, row=row_form)

# Add a field for the global identifier of the register, and a button to search for it on the database
ttk.Label(marco_formulario, text=&#34;ID:&#34;)\
    .grid(column=2, row=row_form, sticky=tk.E)
marco_id = ttk.Frame(marco_formulario, style=&#34;TFrame&#34;)
marco_id.grid(column=3, row=row_form, columnspan=1, sticky=tk.W)

ttk.Entry(marco_id, textvariable=identificador, font=(&#34;Gotham Light&#34;, 10), width=19)\
    .grid(column=0, row=0)
search_img = PhotoImage(file=r&#34;.\imgs\search.png&#34;)
ttk.Button(marco_id, image=search_img, command=buscar_id, width=5, padding=(0))\
    .grid(column=1, row=0, sticky=tk.W)

# Add a number field which validates character entry
val = marco_formulario.register(verificar_numerico)
ttk.Label(marco_formulario, text=&#34;Importe:&#34;)\
    .grid(column=4, row=row_form, sticky=tk.E)
ttk.Entry(marco_formulario, textvariable=importe, font=(&#34;Gotham Light&#34;, 10), width=22,
        validate=&#34;key&#34;, validatecommand=(val, &#34;%S&#34;))\
    .grid(column=5, row=row_form)

# Add a combobox from a given collection with a bound method that updates multiple widgets
ttk.Label(marco_formulario, text=&#34;Estado:&#34;)\
    .grid(column=6, row=row_form, sticky=tk.E)
estados_cb = ttk.Combobox(marco_formulario, state=&#34;readonly&#34;,
    font=(&#34;Gotham Light&#34;, 10), width=20)
estados_cb[&#39;values&#39;] = [&#34;--&#34;, &#34;OK&#34;, &#34;INCIDENCIA&#34;, &#34;KO&#34;]
estados_cb.current(0)
estados_cb.grid(column=7, row=row_form)
estados_cb.bind(&#34;&lt;&lt;ComboboxSelected&gt;&gt;&#34;, estado_seleccionado)

row_form += 1

################################################################################
# Add a separator
ttk.Separator(marco_formulario,orient=&#39;horizontal&#39;)\
    .grid(column=0, row=row_form, columnspan=8, sticky=&#39;ew&#39;, pady=5)
row_form += 1

# Section with explicitly defined variables for them to be disabled or enabled
campo_label = ttk.Label(marco_formulario, text=&#34;Campo:&#34;, state=&#34;disabled&#34;)
campo_label.grid(column=0, row=row_form, sticky=tk.E)
campo_entry = ttk.Entry(marco_formulario, textvariable=campo, font=(&#34;Gotham Light&#34;, 10),
    width=22, state=&#34;disabled&#34;)
campo_entry.grid(column=1, row=row_form)

num_label = ttk.Label(marco_formulario, text=&#34;Nº llamadas:&#34;, state=&#34;disabled&#34;)
num_label.grid(column=2, row=row_form, sticky=tk.E)
num_llamadas.set(0)
num_entry = ttk.Entry(marco_formulario, textvariable=num_llamadas, font=(&#34;Gotham Light&#34;, 10),
    width=22, state=&#34;disabled&#34;)
num_entry.grid(column=3, row=row_form)

fres_label = ttk.Label(marco_formulario, text=&#34;Fecha\nresolución:&#34;, state=&#34;disabled&#34;)
fres_label.grid(column=4, row=row_form, sticky=tk.E)
cal_resolucion = DateEntry(marco_formulario, textvariable=fecha_resolucion,
    font=(&#34;Gotham Light&#34;, 10), state=&#34;disabled&#34;, 
    justify=tk.CENTER, width=20, locale=&#39;es_ES&#39;, date_pattern=&#34;dd-MM-yyyy&#34;)
cal_resolucion.grid(column=5, row=row_form)

opres_label = ttk.Label(marco_formulario, text=&#34;Operador\nresolución:&#34;, state=&#34;disabled&#34;)
opres_label.grid(column=6, row=row_form, sticky=tk.E)
oper_res_cb = ttk.Combobox(marco_formulario, textvariable=operador_resolucion,
    state=&#34;disabled&#34;, font=(&#34;Gotham Light&#34;, 10), width=20)
oper_res_cb[&#39;values&#39;] = [u[1] for u in usuarios]
oper_res_cb.grid(column=7, row=row_form)

row_form += 1

################################################################################
# Add a separator
ttk.Separator(marco_formulario,orient=&#39;horizontal&#39;)\
    .grid(column=0, row=row_form, columnspan=8, sticky=&#39;ew&#39;, pady=5)
row_form += 1

# Add a text field form comments
ttk.Label(marco_formulario, text=&#34;Observaciones:&#34;)\
    .grid(column=2, row=row_form, sticky=tk.E)
observaciones = tk.Text(marco_formulario, font=(&#34;Gotham Light&#34;, 10), width=50, 
        height=3, background=&#34;#F0F0F0&#34;, relief=&#34;sunken&#34;, wrap=tk.WORD)
observaciones.grid(column=3, row=row_form, columnspan=4, sticky=tk.W+tk.E+tk.N+tk.S)

row_form += 1

################################################################################
# Add a separator
ttk.Separator(marco_formulario,orient=&#39;horizontal&#39;)\
    .grid(column=0, row=row_form, columnspan=8, sticky=&#39;ew&#39;, pady=5)
row_form += 1

# Resize the grid columns and rows
tk_utils.redimensionar_filas_columnas(marco_formulario)


################################################################################
# Add a button to submit the form and a button to clear the form
botones = ttk.Frame(ventana_principal, style=&#34;TFrame&#34;)
botones.grid(column=0, row=3, columnspan=4, pady=(10, 10), padx=(10, 10))

confirmar = ttk.Button(botones, text=&#34;Confirmar&#34;, command=submit)\
    .grid(column=1, row=0, pady=(10, 20), padx=(0, 15))
limpiar = ttk.Button(botones, text=&#34;Limpiar&#34;, command=clear)\
    .grid(column=2, row=0, pady=(10, 20), padx=(15, 0))

clear()


################################################################################
# Center the window in the screen
tk_utils.centrar_ventana(ventana_principal)

# Start GUI
ventana_principal.mainloop()</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="main.about"><code class="name flex">
<span>def <span class="ident">about</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Mensaje de información</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def about():
    &#39;&#39;&#39;Mensaje de información&#39;&#39;&#39;
    messagebox.showinfo(&#34;Información&#34;, &#34;Aplicación creada por Alejandro Sánchez Rodríguez&#34;)</code></pre>
</details>
</dd>
<dt id="main.buscar_id"><code class="name flex">
<span>def <span class="ident">buscar_id</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Create a function that searches for a record in the database from a given ID</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def buscar_id():
    &#39;&#39;&#39;Create a function that searches for a record in the database from a given ID&#39;&#39;&#39;
    # If the entry field is empty, show an error message
    if not identificador.get():
        messagebox.showerror(&#34;Error&#34;, &#34;El campo ID es obligatorio&#34;)
    else:
        # Clear the entry fields and comboboxes
        clear()
        # Search for the record in the database
        record = database.get_registro(identificador.get())
        # If the record exists, fill the entry fields and comboboxes with its values
        if record:
            print(record)
        # If the record doesn&#39;t exist, show an error message
        else:
            messagebox.showerror(&#34;Error&#34;, &#34;No existe ningún registro con ese ID&#34;)</code></pre>
</details>
</dd>
<dt id="main.clear"><code class="name flex">
<span>def <span class="ident">clear</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Create a function that clears the form</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def clear():
    &#39;&#39;&#39;Create a function that clears the form&#39;&#39;&#39;
    # Clear the entry fields and comboboxes
    fecha_entrada.set(&#34;&#34;)
    identificador.set(&#34;&#34;)
    importe.set(&#34;&#34;)
    operador.set(&#34;&#34;)
    estados_cb.current(0)
    campo.set(&#34;&#34;)
    fecha_resolucion.set(&#34;&#34;)
    operador_resolucion.set(&#34;&#34;)
    observaciones.delete(&#39;1.0&#39;, &#34;end-1c&#34;)
    num_llamadas.set(&#34;&#34;)</code></pre>
</details>
</dd>
<dt id="main.estado_seleccionado"><code class="name flex">
<span>def <span class="ident">estado_seleccionado</span></span>(<span>event)</span>
</code></dt>
<dd>
<div class="desc"><p>Create a Listener for the estado combobox</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def estado_seleccionado(event):
    &#39;&#39;&#39;Create a Listener for the estado combobox&#39;&#39;&#39;
    if estados_cb.get() == &#34;INCIDENCIA&#34;:
        toggle_use_incidencias(&#34;enabled&#34;)
    else:
        toggle_use_incidencias(&#34;disabled&#34;)</code></pre>
</details>
</dd>
<dt id="main.exportar"><code class="name flex">
<span>def <span class="ident">exportar</span></span>(<span>selector, fechas='', window=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Create a function that extracts the data from the database and creates an Excel file</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def exportar(selector, fechas=&#34;&#34;, window=None):
    &#39;&#39;&#39;Create a function that extracts the data from the database and creates an Excel file&#39;&#39;&#39;
    # Get the data from the database
    data = None
    nombre = None
    if selector == 1:
        aux = fechas.split(&#34; - &#34;)
        fechas = (aux[0], aux[1])
        data = database.get_all_registros_fecha_entrada(fechas)
        nombre = f&#34;Extracción {aux[0]} - {aux[1]}.xlsx&#34;
    elif selector == 2:
        data = database.get_all_registros_fecha_entrada(fechas)
        nombre = f&#34;Extracción {fechas}.xlsx&#34;
    else:
        data = database.get_all_registros()
        nombre = &#34;Extracción global.xlsx&#34;

    # Create a new Excel file
    excel = Excel()
    excel.crear_archivo(nombre)

    # Add headers to the Excel file
    excel.rellenar_cabeceras(cabeceras)

    # Add the data to the Excel file
    excel.rellenar_hoja(data)

    # Format the Excel file
    excel.formato_hoja()
    excel.formato_cabecera()

    # Save the Excel file
    excel.guardar_archivo_como()

    # Close the Excel file
    excel.cerrar_archivo()

    # Show a message to the user
    messagebox.showinfo(&#34;Información&#34;, &#34;El archivo se ha exportado correctamente&#34;)</code></pre>
</details>
</dd>
<dt id="main.exportar_aux"><code class="name flex">
<span>def <span class="ident">exportar_aux</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Create a function that shows an auxiliary window to choose whether to
extract all the registers or only ones within a certain date range</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def exportar_aux():
    &#39;&#39;&#39;
        Create a function that shows an auxiliary window to choose whether to 
        extract all the registers or only ones within a certain date range
    &#39;&#39;&#39;
    # Create a new window
    export_window = tk.Toplevel()
    export_window.title(&#34;Exportar&#34;)
    export_window.resizable(False, False)
    export_window.iconbitmap(&#34;imgs/favicon.ico&#34;)

    # Create a label to show a message to the user
    label = tk.Label(export_window, text=&#34;¿Qué registros desea exportar?&#34;, font=(&#34;Gotham Bold&#34;, 14))
    label.grid(row=0, column=0, columnspan=3, pady=10)

    # Create a button to export all the registers
    button_all = tk.Button(export_window, text=&#34;Todos&#34;, 
            command= lambda: [exportar(0, None), export_window.destroy()])
    button_all.grid(row=1, column=0, pady=3)

    # Create a frame to group the date selectors
    frame = tk.Frame(export_window)
    frame.grid(row=1, column=1, pady=3)

    # Create two date selectors to choose the date range
    date_from = DateEntry(frame, width=12, background=&#39;darkblue&#39;, foreground=&#39;white&#39;, 
                        borderwidth=2, locale=&#34;es_ES&#34;, date_pattern=&#34;dd-MM-yyyy&#34;)
    date_from.pack(pady=3)
    date_to = DateEntry(frame, width=12, background=&#39;darkblue&#39;, foreground=&#39;white&#39;, 
                        borderwidth=2, locale=&#34;es_ES&#34;, date_pattern=&#34;dd-MM-yyyy&#34;)
    date_to.pack(pady=3)

    # Create a button to export only the registers within a certain date range
    button_range = tk.Button(frame, text=&#34;Rango de fechas&#34;, 
            command= lambda: [exportar(1, f&#34;{date_from.get()} - {date_to.get()}&#34;), export_window.destroy()])
    button_range.pack(pady=3)

    # Create a frame to group the date selector and button
    frame2 = tk.Frame(export_window)
    frame2.grid(row=1, column=2, pady=3)

    # Create a date selector and button to export only the registers from a certain date
    date = DateEntry(frame2, width=12, background=&#39;darkblue&#39;, foreground=&#39;white&#39;, 
                        borderwidth=2, locale=&#34;es_ES&#34;, date_pattern=&#34;dd-MM-yyyy&#34;)
    date.pack(pady=3)
    button_date = tk.Button(frame2, text=&#34;A partir de una fecha&#34;,
            command= lambda: [exportar(2, f&#34;{date.get()}&#34;), export_window.destroy()])
    button_date.pack(pady=3)

    # Create a button to close the window
    button_close = tk.Button(export_window, text=&#34;Cerrar&#34;, command=export_window.destroy)
    button_close.grid(row=2, column=0, columnspan=3, pady=3)

    tk_utils.centrar_ventana(export_window)</code></pre>
</details>
</dd>
<dt id="main.help"><code class="name flex">
<span>def <span class="ident">help</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Create a function that displays an overlay with help for the user</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def help():
    &#39;&#39;&#39;Create a function that displays an overlay with help for the user&#39;&#39;&#39;
    # Create a new window
    ventana_ayuda = tk.Toplevel(ventana_principal)
    ventana_ayuda.title(&#34;Ayuda&#34;)
    ventana_ayuda.resizable(False, False)
    ventana_ayuda.iconbitmap(&#34;imgs/favicon.ico&#34;)
    ventana_ayuda.configure(background=&#34;#FFFFFF&#34;)

    # Create a frame for the content
    frame = ttk.Frame(ventana_ayuda)
    frame.pack(padx=10, pady=10)

    # Create a label with the help text
    help_text = &#34;&#34;&#34;
        Este programa permite registrar, buscar, modificar y eliminar registros de 
        **NOMBRE DEL SERVICIO**.\n
        - Para registrar un nuevo registro, rellene todos los campos del formulario y
        pulse el botón &#34;Confirmar. Todos los campos del cuerpo principal son
        obligatorios.\n
        - Para vaciar el formulario, pulse el botón &#34;Limpiar&#34;.\n
        - Si el estado del registro es &#34;INCIDENCIA&#34;, se habilitarán los campos
        &#34;Campo&#34;, &#34;Fecha de resolución&#34;, &#34;Operador de resolución&#34; y &#34;Número de
        llamadas&#34;, que pasarán a ser obligatorios.\n
        - Para buscar un registro, introduzca su ID en el campo correspondiente y
        pulse el botón &#34;Buscar&#34; (icono de lupa).\n
        - Para modificar un registro, busque el registro y modifique los campos que
        desee. Pulse el botón &#34;Confirmar&#34; para guardar los cambios.\n
        - Para eliminar un registro, busque el registro y pulse el botón &#34;Eliminar&#34;.
        Se mostrará una ventana de confirmación.\n\n
        - Para exportar los registros a Excel o cargar un fichero de datos, pulse 
        los botones &#34;Exportar&#34; e &#34;Importar&#34; del menú &#34;Archivo&#34;, respectivamente.\n\n
    &#34;&#34;&#34;

    title_label = ttk.Label(frame, text=&#34;Ayuda&#34;, font=(&#34;Gotham&#34;, 18, &#34;bold&#34;))
    title_label.grid(row=0, column=0, padx=10, pady=10, sticky=&#34;NSEW&#34;)

    help_label = ttk.Label(frame, text=help_text)
    help_label.grid(row=1, column=0, padx=10, pady=10, sticky=&#34;NSEW&#34;)

    # Create a button to close the window
    close_button = ttk.Button(frame, text=&#34;Cerrar&#34;, command=ventana_ayuda.destroy)
    close_button.grid(row=2, column=0, padx=10, pady=10, sticky=&#34;NSEW&#34;)

    # Center the window
    tk_utils.centrar_ventana(ventana_ayuda)

    # Show the window
    ventana_ayuda.mainloop()</code></pre>
</details>
</dd>
<dt id="main.importar"><code class="name flex">
<span>def <span class="ident">importar</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Create a function that imports data from an Excel file to the database</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def importar():
    &#39;&#39;&#39;Create a function that imports data from an Excel file to the database&#39;&#39;&#39;
    # Create a new Excel file
    excel = Excel()
    excel.cargar_archivo()

    # Check format integrity and insert the data in the database
    if not verificar_cabeceras(excel.datos[0]):
        messagebox.showerror(&#34;Error&#34;, &#34;El archivo no tiene el formato correcto&#34;)
        return
    elif not verificar_datos(excel.datos[1:]):
        return
    else:
        # Delete the headers from the data
        del excel.datos[0]

        # Insert the data in the database
        database.insert_multiples_registros(excel.datos)

    # Show a message to the user
    messagebox.showinfo(&#34;Información&#34;, &#34;El archivo se ha importado correctamente&#34;)</code></pre>
</details>
</dd>
<dt id="main.submit"><code class="name flex">
<span>def <span class="ident">submit</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Create a function that submits the form</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def submit():
    &#39;&#39;&#39;Create a function that submits the form&#39;&#39;&#39;
    # If operador is not selected, show an error message
    if not operador.get():
        messagebox.showerror(&#34;Error&#34;, &#34;El campo operador es obligatorio&#34;)
        return

    # If any of the entry fields or comboboxes are empty, show an error message
    if not fecha_entrada.get() or not observaciones.get(&#39;1.0&#39;, &#34;end-1c&#34;) or \
            not identificador.get() or not importe.get() or estados_cb.get() == &#34;--&#34; or \
            (estados_cb.get() == &#34;INCIDENCIA&#34; and \
                (not fecha_resolucion.get() or not operador_resolucion.get() \
                or not num_llamadas.get() or not campo.get())):
        messagebox.showerror(&#34;Error&#34;, &#34;Todos los campos son obligatorios&#34;)
        return
    
    # If the record already exists, ask for confirmation to overwrite it
    if database.get_registro_by(&#34;identificador&#34;, identificador.get()):
        if not messagebox.askyesno(&#34;Confirmar&#34;, &#34;Ya existe un registro con ese ID. ¿Desea sobreescribirlo?&#34;):
            return
        
    # If the record doesn&#39;t exist, ask for confirmation to create it
    elif not messagebox.askyesno(&#34;Confirmar&#34;, &#34;¿Desea crear un nuevo registro?&#34;):
        return

    # Create a list with the values of the entry fields and comboboxes
    values = [
        fecha_entrada.get(),
        operador.get(),
        identificador.get(),
        importe.get(),
        estados_cb.get(),
        campo.get(),
        int(num_llamadas.get()) if num_llamadas.get() else 0,
        fecha_resolucion.get(),
        operador_resolucion.get(),
        observaciones.get(&#39;1.0&#39;, &#34;end-1c&#34;),
    ]

    # Insert the record in the database
    database.insert_registro(values)

    # Clear the entry fields and comboboxes
    clear()</code></pre>
</details>
</dd>
<dt id="main.toggle_use_incidencias"><code class="name flex">
<span>def <span class="ident">toggle_use_incidencias</span></span>(<span>new_state)</span>
</code></dt>
<dd>
<div class="desc"><p>Create a function that disables or enables every field in the incidencias category</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_use_incidencias(new_state):
    &#39;&#39;&#39;Create a function that disables or enables every field in the incidencias category&#39;&#39;&#39;
    # Disable or enable every field in the incidencias category
    campo_label.configure(state=new_state)
    campo_entry.configure(state=new_state)
    fres_label.configure(state=new_state)
    cal_resolucion.configure(state=new_state)
    opres_label.configure(state=new_state)
    oper_res_cb.configure(state=new_state)
    num_label.configure(state=new_state)
    num_entry.configure(state=new_state)</code></pre>
</details>
</dd>
<dt id="main.verificar_cabeceras"><code class="name flex">
<span>def <span class="ident">verificar_cabeceras</span></span>(<span>headers)</span>
</code></dt>
<dd>
<div class="desc"><p>Create a function that verifies the Excel file headers</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def verificar_cabeceras(headers):
    &#39;&#39;&#39;Create a function that verifies the Excel file headers&#39;&#39;&#39;
    # Check if the headers are correct
    if headers != cabeceras[1:]:
        # Show a message to the user
        messagebox.showerror(&#34;Error&#34;, &#34;El archivo no tiene los campos correctos&#34;)
        return False
    return True</code></pre>
</details>
</dd>
<dt id="main.verificar_datos"><code class="name flex">
<span>def <span class="ident">verificar_datos</span></span>(<span>datos)</span>
</code></dt>
<dd>
<div class="desc"><p>Create a function that verifies the integrity of the data</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def verificar_datos(datos):
    &#39;&#39;&#39;Create a function that verifies the integrity of the data&#39;&#39;&#39;
    date_regex = r&#34;^\d{2}-\d{2}-\d{4}$&#34;
    for registro in datos:
        # Check if fecha entrada has a valid date format
        if not re.match(date_regex, registro[0]):
            messagebox.showerror(&#34;Error&#34;, &#34;Fecha de entrada incorrecta&#34;)
            return False
        # Check if the next 2 fields are empty
        if registro[1] != &#34;&#34; or registro[2] != &#34;&#34;:
            messagebox.showerror(&#34;Error&#34;, &#34;El registro tiene campos vacíos&#34;)
            return False
        # Check if importe is a valid number
        try:
            float(registro[3])
        except ValueError:
            messagebox.showerror(&#34;Error&#34;, &#34;Importe incorrecto&#34;)
            return False
        # If estado is INCIDENCIA, check whether the next fields are valid
        if registro[4] == &#34;INCIDENCIA&#34;:
            # Check if registro[5][8][9] are empty
            if registro[5] != &#34;&#34; or registro[8] != &#34;&#34; or registro[9] != &#34;&#34;:
                messagebox.showerror(&#34;Error&#34;, &#34;El registro tiene campos vacíos&#34;)
                return False
            # Check if registro[6] is a valid integer
            try:
                int(registro[6])
            except ValueError:
                messagebox.showerror(&#34;Error&#34;, &#34;Número de llamadas incorrecto&#34;)
                return False
            # Check if registro[7] is a valid date
            if not re.match(date_regex, registro[7]):
                messagebox.showerror(&#34;Error&#34;, &#34;Fecha de resolución incorrecta&#34;)
                return False
    return True</code></pre>
</details>
</dd>
<dt id="main.verificar_numerico"><code class="name flex">
<span>def <span class="ident">verificar_numerico</span></span>(<span>char)</span>
</code></dt>
<dd>
<div class="desc"><p>Create a function that validates an entry field and accepts only numbers and dots</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def verificar_numerico(char):
    &#39;&#39;&#39;Create a function that validates an entry field and accepts only numbers and dots&#39;&#39;&#39;
    return char.isdigit() or char == &#34;&#34; or char == &#34;.&#34;</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="main.about" href="#main.about">about</a></code></li>
<li><code><a title="main.buscar_id" href="#main.buscar_id">buscar_id</a></code></li>
<li><code><a title="main.clear" href="#main.clear">clear</a></code></li>
<li><code><a title="main.estado_seleccionado" href="#main.estado_seleccionado">estado_seleccionado</a></code></li>
<li><code><a title="main.exportar" href="#main.exportar">exportar</a></code></li>
<li><code><a title="main.exportar_aux" href="#main.exportar_aux">exportar_aux</a></code></li>
<li><code><a title="main.help" href="#main.help">help</a></code></li>
<li><code><a title="main.importar" href="#main.importar">importar</a></code></li>
<li><code><a title="main.submit" href="#main.submit">submit</a></code></li>
<li><code><a title="main.toggle_use_incidencias" href="#main.toggle_use_incidencias">toggle_use_incidencias</a></code></li>
<li><code><a title="main.verificar_cabeceras" href="#main.verificar_cabeceras">verificar_cabeceras</a></code></li>
<li><code><a title="main.verificar_datos" href="#main.verificar_datos">verificar_datos</a></code></li>
<li><code><a title="main.verificar_numerico" href="#main.verificar_numerico">verificar_numerico</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>